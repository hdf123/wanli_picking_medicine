<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>咨询</title>
		<link rel="stylesheet" href="../../css/base.css" />
		<link rel="stylesheet" href="../../css/iconfont.css" />
		<link rel="stylesheet" href="../../css/layout.css" />
		<link rel="stylesheet" href="../../css/swiper-4.3.3.min.css" />
		<link rel="stylesheet" href="css/consulting.css" />
		<script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/swiper-4.3.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/ajaxs.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<header>
			<div class="consua"></div>
		</header>
		<section class="sets">
			<div>
				<div class="swiper-container" id="swiper1">
				    <div class="swiper-wrapper"></div>
				</div>
				<div class="consuc"></div>
			</div>
		</section>
		<footer class="footersd">
			<a href="./home.html" id="home" class="iconfont icon-51">
				<span>首页</span>
			</a>
			<a href="./consulting.html" id="videos" class="iconfont icon-ziliao">
				<span>咨讯</span>
			</a>
			<a href="./my.html" id="my" class="iconfont icon-wode">
				<span>我的</span>
			</a>
		</footer>
<script type="text/javascript">
	$(function(){
		ajaxsd("Information/findAllType",'post',{},function(data){
			var ks="";
			for(i in data){
				ks+=`<div data-informa=${data[i].informationTypeId}>
						<div>${data[i].typeName}</div>
					</div>`;
			}
			$(".consua").html(ks);
			var informa=1;
			funk(informa);
			function funk(informa){
				//根据资讯分类 id  查询轮播资讯
				ajaxsd("Information/findInformationBroadcast",'post',{informationTypeId:informa},function(data){
					var ka="";
					for(i in data){
						ka+=`<div class="swiper-slide" data-informationid=${data[i].informationId}>
					        	<img src=${data[i].picture} alt="" />
					        	<div>${data[i].title}</div>
					        </div>`;
					}
					$("#swiper1>.swiper-wrapper").html(ka);
					var mySwiper1 = new Swiper ('#swiper1',{//推荐recommend
						autoplay: true,//可选选项，自动滑动
					    direction: 'horizontal',
					})
					$("#swiper1").on("click",".swiper-slide",function(){
						var index=$(this).data("informationid");
						console.log(index);
						window.location.href="../child/details.html?index="+index;
					})
				},function(err){
					console.log(err);
				})
				//条件分页查询资讯
				ajaxsd("Information/findInformation",'post',{informationTypeId:informa},function(data){
					var data=data.rows;
					var kst="";
					for(i in data){
						var dateee = new Date(data[i].createTime).toJSON();
			        	var date = new Date(+new Date(dateee)+8*3600*1000).toISOString().replace(/T/g,' ').replace(/\.[\d]{3}Z/,''); 
						var time=date.split(" ");
						kst+=`<div class="consud" data-informationid=${data[i].informationId}>
								<div>
									<img src=${data[i].picture} alt="" />
								</div>
								<div>
									<div>${data[i].title}</div>
									<div>${time[0]}</div>
								</div>
							</div>`;
					}
					$(".consuc").html(kst);
					$(".consuc").on("click",".consud",function(){
						var index=$(this).data("informationid");
						console.log(index);
						window.location.href="../child/details.html?index="+index;
					})
				},function(err){
					console.log(err);
				})
			}
			//分类
			$(".consua>div").click(function(){
				var index=$(this).index();
				informa=$(this).data("informa");//咨询分类
				funk(informa);
				$(".consua>div").eq(index).siblings().children("div").css({"border":"none"});
				$(".consua>div").eq(index).children("div").css({"border-bottom":"0.2rem solid white"});
			})
			
		},function(err){
			console.log(err);
		})
		$(".consub").click(function(){
			window.location.href="../child/details.html";
		})
		$(".consuc>div").click(function(){
			window.location.href="../child/details.html";
		})
	})
</script>
	</body>
</html>

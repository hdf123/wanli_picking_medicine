<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>首页</title>
		<link rel="stylesheet" href="../../css/base.css" />
		<link rel="stylesheet" href="../../css/iconfont.css" />
		<link rel="stylesheet" href="../../css/layout.css" />
		<link rel="stylesheet" href="../../css/swiper-4.3.3.min.css" />
		<link rel="stylesheet" href="css/home.css" />
		<script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/swiper-4.3.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/ajaxs.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.10&key=311194415586a84a3dab215eec8b10bb&plugin=AMap.CitySearch"></script>
	</head>
	<body>
		<header>
			<div id="locations">
				<div class="iconfont icon-weizhi-tianchong"></div>
				<div><span id="asd"></span><i class="iconfont icon-xiala"></i></div>
			</div>
			<div id="symptoms">
				<input type="text" placeholder="乙肝 胃病"/>
				<i class="iconfont icon-sousuo5"></i>
			</div>
		</header>
		<div class="sets">
			<div>
				<div class="swiper-container" id="swiper1">
				    <div class="swiper-wrapper"></div>
				</div>
				<div class="menu">
					<div>
						<div>
							<img src="../../img/home_02.png" alt="" />
						</div>
						<div>查找医院</div>
					</div>
					<div>
						<div>
							<img src="../../img/home_03.png" alt="" />
						</div>
						<div>医疗设备商</div>
					</div>
					<div>
						<div>
							<img src="../../img/home_04.png" alt="" />
						</div>
						<div>医疗技术商</div>
					</div>
				</div>
				<div class="homea">
					<div id="communication">
						<div>
							<img src="../../img/home_05.png" alt="" />
						</div>
						<div>
							交流讨论区
						</div>
					</div>
					<div>
						<div>
							<img src="../../img/home_06.png" alt="" />
						</div>
						<div>服务咨询区</div>
					</div>
				</div>
				<div class="homeb">
					<div>推荐医院</div>
					<div class="yiy"></div>
				</div>
			</div>
		</div>
		<footer class="footersd">
			<a href="./home.html" id="home" class="iconfont icon-51">
				<span>首页</span>
			</a>
			<a href="./consulting.html" id="videos" class="iconfont icon-ziliao">
				<span>咨讯</span>
			</a>
			<a href="./my.html" id="my" class="iconfont icon-wode">
				<span>我的</span>
			</a>
		</footer>
<script type="text/javascript">
	$(function(){
		var mySwiper1 = new Swiper ('#swiper1',{//推荐recommend
			loop:true,
			autoplay: true,//可选选项，自动滑动
		    direction: 'horizontal',
		})
		var location = JSON.parse(localStorage.getItem('location'));//定位城市
		if(location==""||location==undefined){
		    //实例化城市查询类
		    var citysearch = new AMap.CitySearch();
		    //自动获取用户IP，返回当前城市
		    citysearch.getLocalCity(function(status, result) {
		        if (status === 'complete' && result.info==='OK') {
		            if (result && result.city && result.bounds) {
		                var cityinfo = result.city;
		                var citybounds = result.bounds;
		                cityinfo=cityinfo.substring(0,3);
		                if(cityinfo.lastIndexOf("市")==2){
		                	cityinfo=cityinfo.substr(0,cityinfo.lastIndexOf("市"));
		                }
		                document.getElementById('asd').innerHTML =cityinfo;
		                var kk={
		                	aa:cityinfo,
		                	kk:""
		                }
		                localStorage.setItem('location', JSON.stringify(kk));
		            }
		        }else{
		        	$("#asd").html(result.info);
		        }
		    });
		}else{
			$("#asd").html(location.aa);
		}
	//个人信息
		ajaxsd("user/getUsers",'post',{},function(data){
			console.log(data);
			//如还没设置过个人信息，让去设定个人信息
			if(data.sax==null){
//				window.location.href="../child/personal_data.html";
			}
			localStorage.setItem('My_information', JSON.stringify(data));
		},function(err){
			console.log(err);
		})
	//banner
		ajaxsd("content/findContent",'post',{},function(data){
			console.log(data);
			var ks="";
			for(i in data){
				ks+=`<div class="swiper-slide" data-idk=${data[i].url}>
			        	<img src=${data[i].pic} alt="" />
			        </div>`;
			}
			$("#swiper1>.swiper-wrapper").html(ks);
		},function(err){
			console.log(err);
		})
	//推荐医院
		ajaxsd("hospital/searchHospitalUser",'post',{},function(data){
			var arr=data.rows.slice(0,4);
			console.log(arr);
			var ks="";
			for(i in arr){
				ks+=`<div data-sta=${arr[i].hospitalUserId}>
						<div>
							<img src=${arr[i].video} alt="" />
						</div>
						<div>${arr[i].hospitalName}</div>
					</div>`;
			}
			$(".yiy").html(ks);
			$(".yiy>div").click(function(){//推荐医院
				var userid=$(this).data("sta");
				window.location.href="../child/hospital_details.html?userid="+userid;
			})
		},function(err){
			console.log(err);
		})
		$("#locations").click(function(){
			window.location.href="../child/locations.html";
		})
		$(".menu>div").click(function(){
			var index=$(this).index();
			console.log(index);
			if(index==0){//查找医院
				window.location.href="../child/check_hospital.html";
			}else if(index==1){//医疗设备
				window.location.href="../child/equipment.html";
			}else{//技术商
				window.location.href="../child/Technology.html";
			}
		})
		$("#symptoms").click(function(){
			window.location.href="../child/check_hospital.html";
		})
		$(".homea>div:eq(0)").click(function(){//交流讨论
			window.location.href="../child/communication.html";
		})
		$(".homea>div:eq(1)").click(function(){//服务咨询
			window.location.href="../child/service.html";
		})
	})
</script>
	</body>
</html>
